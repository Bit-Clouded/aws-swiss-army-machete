---
platform: linux
inputs:
  - name: ((input))
    path: /
run:
  path: /bin/sh
  dir: alb-rule-assigner
  args:
    - -c
    - |
      set -e
      go get -d ./...
      go test
      go build -o main .
      VERSION=$(head /dev/urandom | tr -dc A-Za-z0-9 | head -c 13 ; echo '')
      cp main ../bin/((bin-name))-${VERSION}
outputs:
  - name: bin

# fly -t prod execute --image golang-build-container \
#   -c ./build-task.yml -j citrus-rind/build-lambda -o lambda-zip=./